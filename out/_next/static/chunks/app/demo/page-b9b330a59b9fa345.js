(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[436],{2168:(e,t,s)=>{Promise.resolve().then(s.bind(s,9013))},9013:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var r=s(5155),a=s(2115);let o="http://localhost:3000",n="".concat(o,"/api/chat"),l="".concat(o,"/api/upload");function i(){let[e,t]=(0,a.useState)(""),[s,o]=(0,a.useState)([]),[i,c]=(0,a.useState)(!1),[d,u]=(0,a.useState)(null),[p,m]=(0,a.useState)(null),[g,h]=(0,a.useState)(null),[x,w]=(0,a.useState)(""),[f,b]=(0,a.useState)(null),y=(0,a.useRef)(null),v=(0,a.useRef)(null);(0,a.useEffect)(()=>{y.current&&y.current.scrollIntoView({behavior:"smooth"})},[s]),(0,a.useEffect)(()=>{o([{content:"Hello! I'm SuperTeacher's AI assistant. You can chat with me about any educational topic, or upload question papers and answer sheets for AI grading. Try saying 'I want to grade a paper' to get started.",role:"assistant",timestamp:new Date}]);let e=localStorage.getItem("superteacher_user_id");if(e)u(e);else{let e=j();localStorage.setItem("superteacher_user_id",e),u(e)}},[]);let j=()=>"user_"+Math.random().toString(36).substring(2,15),k=e=>{b(e),v.current&&v.current.click()},N=e=>{let t={content:e,role:"assistant",timestamp:new Date};o(e=>[...e,t])},S=async s=>{if(s.preventDefault(),!e.trim()||i)return;let r={content:e,role:"user",timestamp:new Date};o(e=>[...e,r]),c(!0);let a=e.toLowerCase();if(t(""),a.includes("grade")||a.includes("check")||a.includes("evaluate")||a.includes("score")||a.includes("assess")||a.includes("review paper")){N("I'd be happy to help grade papers! Please upload a question paper PDF first, then the answer sheet PDF. Also, let me know the subject."),c(!1);return}if((p||g)&&(a.includes("subject")||a.includes("topic")||a.includes("course")||a.length<30||!x&&(p||g))){let t=e;if(e.toLowerCase().includes("subject is")||e.toLowerCase().includes("subject:")){var l,u;t=(null===(l=e.split("is")[1])||void 0===l?void 0:l.trim())||(null===(u=e.split(":")[1])||void 0===u?void 0:u.trim())||e}w(t),p&&g?(N("Great! I've set the subject to \"".concat(t,"\". I'll start grading now!")),await L()):N("I've set the subject to \"".concat(t,'". ').concat(p?"":"Please upload a question paper. ").concat(g?"":"Please upload an answer sheet. ")),c(!1);return}try{let t=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e,userId:d})});if(!t.ok)throw Error("Server error: ".concat(t.status));let s={content:(await t.json()).message,role:"assistant",timestamp:new Date};o(e=>[...e,s])}catch(t){let e={content:"Error: ".concat(t instanceof Error?t.message:"Failed to get response",". Please try again."),role:"assistant",timestamp:new Date};o(t=>[...t,e])}finally{c(!1)}},L=async()=>{if(!p||!g||!x){N("I need both a question paper, answer sheet, and subject information to grade. Please make sure you've provided all three."),console.log("Missing required components for grading:",{hasQuestionPaper:!!p,hasAnswerSheet:!!g,hasSubject:!!x});return}c(!0),N("Processing your grading request. This may take a minute...");try{console.log("Preparing form data for grading request...");let e=new FormData;e.append("subject",x),e.append("questionPaper",p),e.append("answerSheet",g),console.log("Sending grading request to:",l);let t=await fetch(l,{method:"POST",body:e});if(!t.ok)throw Error("Server error: ".concat(t.status));console.log("Grading request successful, processing response...");let s=t.headers.get("Content-Type");if(s&&s.includes("application/pdf")){let e=await t.blob(),s=URL.createObjectURL(e),r={content:"Here's the graded result for your submission:",role:"assistant",timestamp:new Date,isFile:!0,fileType:"application/pdf",fileUrl:s,fileName:"graded-result-".concat(new Date().toISOString().slice(0,10),".pdf")};o(e=>[...e,r]),N("I've completed grading your paper. You can view and download the PDF above. Would you like to grade another paper or do you have any questions about the results?")}else{let e=await t.json();N("Grading completed! ".concat(e.message||"Your paper has been graded successfully."))}m(null),h(null),w("")}catch(e){console.error("Error during grading process:",e),N("There was an error processing your request: ".concat(e instanceof Error?e.message:"Unknown error occurred",". Please try again."))}finally{c(!1)}},P=(e,t)=>{let s=document.createElement("a");s.href=e,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s)};return(0,r.jsxs)("div",{className:"min-h-screen flex flex-col",style:{backgroundImage:'linear-gradient(rgba(255,255,255,0.95), rgba(255,255,255,0.95)), url("/images/background.png")',backgroundSize:"cover",backgroundPosition:"center"},children:[(0,r.jsx)("header",{className:"backdrop-blur-md bg-white/70 shadow-md",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-4 sm:px-6 lg:px-8",children:(0,r.jsx)("div",{className:"flex justify-between items-center",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("img",{src:"/images/Stlogo.png",alt:"Logo",className:"w-10 h-10 object-contain rounded-full"}),(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"SuperTeacher AI Chat"})]})})})}),(0,r.jsx)("main",{className:"flex-grow flex flex-col",children:(0,r.jsx)("div",{className:"max-w-4xl w-full mx-auto px-4 py-6 sm:px-6 lg:px-8 flex-grow flex flex-col",children:(0,r.jsxs)("div",{className:"bg-white/80 backdrop-blur-sm shadow-lg rounded-2xl flex-grow flex flex-col overflow-hidden border border-gray-200",children:[(0,r.jsxs)("div",{className:"flex-grow overflow-y-auto p-4 space-y-4",children:[s.map((e,t)=>(0,r.jsx)("div",{className:"flex ".concat("user"===e.role?"justify-end":"justify-start"),children:(0,r.jsxs)("div",{className:"max-w-xs md:max-w-md lg:max-w-lg xl:max-w-xl rounded-2xl px-4 py-3 ".concat("user"===e.role?"bg-black text-white":"bg-gray-100 text-gray-900"),children:[!e.isFile&&(0,r.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:e.content}),e.isFile&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm whitespace-pre-wrap mb-2",children:e.content}),"application/pdf"===e.fileType&&e.fileUrl&&(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsx)("div",{className:"border border-gray-300 rounded-xl overflow-hidden mb-2",children:(0,r.jsx)("iframe",{src:e.fileUrl,className:"w-full",style:{height:"300px"},title:"PDF Document"})}),(0,r.jsx)("button",{onClick:()=>P(e.fileUrl,e.fileName||"document.pdf"),className:"text-xs bg-black text-white px-3 py-1.5 rounded-xl hover:bg-gray-800 transition-colors",children:"Download PDF"})]})]}),(0,r.jsx)("p",{className:"text-xs opacity-70 mt-1",children:e.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},t)),(0,r.jsx)("div",{ref:y})]}),(0,r.jsx)("input",{type:"file",ref:v,accept:"application/pdf",onChange:e=>{if(e.target.files&&e.target.files.length>0){let t=e.target.files[0],s={content:"Uploaded ".concat("question"===f?"question paper":"answer sheet",": ").concat(t.name),role:"user",timestamp:new Date,isFile:!0,fileType:t.type,fileName:t.name};o(e=>[...e,s]),"question"===f?(m(t),N("I've received your question paper. Now, please upload the corresponding answer sheet or tell me the subject if you haven't already."),g&&x&&L()):(h(t),N("I've received your answer sheet. "+(x?p?"I'll start grading now!":"Please upload the question paper to continue.":"Please tell me the subject for grading.")),p&&x&&L()),e.target.value=""}},className:"hidden"}),(0,r.jsxs)("div",{className:"border-t border-gray-200 p-4 bg-white/80",children:[(0,r.jsxs)("div",{className:"flex flex-wrap mb-3 gap-2",children:[(0,r.jsxs)("button",{type:"button",onClick:()=>k("question"),disabled:i,className:"text-xs border border-gray-300 bg-white hover:bg-gray-100 text-gray-800 px-3 py-1.5 rounded-xl flex items-center transition-colors",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Upload Question Paper"]}),(0,r.jsxs)("button",{type:"button",onClick:()=>k("answer"),disabled:i,className:"text-xs border border-gray-300 bg-white hover:bg-gray-100 text-gray-800 px-3 py-1.5 rounded-xl flex items-center transition-colors",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Upload Answer Sheet"]})]}),(0,r.jsxs)("div",{className:"flex flex-wrap mb-3 gap-3 text-xs text-gray-500",children:[p&&(0,r.jsxs)("div",{className:"bg-green-50 text-green-700 px-2 py-1 rounded-lg flex items-center",children:[(0,r.jsx)("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),"Question Paper: ",p.name]}),g&&(0,r.jsxs)("div",{className:"bg-green-50 text-green-700 px-2 py-1 rounded-lg flex items-center",children:[(0,r.jsx)("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),"Answer Sheet: ",g.name]}),x&&(0,r.jsxs)("div",{className:"bg-green-50 text-green-700 px-2 py-1 rounded-lg flex items-center",children:[(0,r.jsx)("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),"Subject: ",x]}),p&&g&&x&&!i&&(0,r.jsxs)("button",{onClick:L,className:"ml-auto bg-black text-white px-3 py-1 rounded-xl hover:bg-gray-800 transition-colors flex items-center",children:[(0,r.jsx)("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),"Grade Now"]})]}),(0,r.jsxs)("form",{onSubmit:S,className:"flex items-center",children:[(0,r.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:p&&!x?"Tell me the subject for grading...":"Type your message...",className:"flex-grow shadow-sm focus:ring-2 focus:ring-black focus:border-black block w-full text-sm border-gray-300 rounded-xl px-4 py-2.5 mr-3",disabled:i}),(0,r.jsx)("button",{type:"submit",disabled:i||!e.trim(),className:"inline-flex items-center px-4 py-2.5 border border-transparent text-sm font-medium rounded-xl shadow-sm text-white bg-black hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-black transition-colors ".concat(i||!e.trim()?"opacity-50 cursor-not-allowed":""),children:i?(0,r.jsx)("div",{className:"w-5 h-5 border-t-2 border-b-2 border-white rounded-full animate-spin"}):"Send"})]})]})]})})}),(0,r.jsx)("footer",{className:"bg-white/70 backdrop-blur-md border-t border-gray-200",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("p",{className:"text-center text-sm text-gray-500",children:["\xa9 ",new Date().getFullYear()," SuperTeacher AI. All rights reserved."]})})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,517,358],()=>t(2168)),_N_E=e.O()}]);